---
permalink: protect-sco/task_restore_and_recover_pluggable_database_using_point_in_time_recovery.html 
sidebar: sidebar 
keywords: PDB, pluggable database, restore, CDB, PITR, point-in-time recovery, RMAN 
summary: 'コンテナ データベース (CDB) 内の他の PDB に影響を与えることなく、破損または削除されたプラガブル データベース (PDB) をリストアおよびリカバリできます。  SnapCenterは RMAN を使用して、PDB のポイントインタイムリカバリ (PITR) を実行します。' 
---
= ポイントインタイム リカバリを使用したプラガブル データベースのリストアとリカバリ
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
破損または削除されたプラガブル データベース（PDB）は、コンテナ データベース（CDB）内の他のPDBに影響を与えることなくリストアおよびリカバリできます。SnapCenterは、RMANを使用してPDBのポイントインタイム リカバリ（PITR）を実行します。

*始める前に*

* PDBのPITRを実行するために必要なバックアップをカタログ化してマウントする必要があります。
+

NOTE: RACセットアップでは、RACセットアップのすべてのノードでPDBを手動で閉じる（状態をマウント済みに変更する）必要があります。

* root以外のユーザとしてプラグインをインストールした場合は、実行権限をプリスクリプト ディレクトリとポストスクリプト ディレクトリに手動で割り当てる必要があります。


*このタスクについて*

PITR処理中、RMANは指定された補助デスティネーションに補助インスタンスを作成します。補助デスティネーションには、マウント ポイントまたはASMディスク グループを指定できます。マウントされた場所に十分なスペースがある場合は、専用のマウント ポイントの代わりにいずれかのマウントされた場所を再利用できます。

PDBのPITRを実行するには、日時またはSCNを指定する必要があります。RMANは、読み取り / 書き込み、読み取り専用、またはデータファイルを含む削除されたPDBをリカバリできます。

リストアとリカバリには、以下の制限があります。

* 一度に1つのPDB
* PDB内の1つの表領域
* 同じPDBの複数の表領域



NOTE: RACセットアップでは、RACの任意のノードから表領域のPITRを実行できます。

*手順*

. 左側のナビゲーション ペインで [*リソース*] をクリックし、リストから適切なプラグインを選択します。
. [リソース] ページで、[表示] リストから [データベース] または [リソース グループ] を選択します。
. データベースの詳細ビューまたはリソース グループの詳細ビューで、タイプが単一インスタンス（マルチテナント）のデータベースを選択します。
+
データベース トポロジのページが表示されます。

. [コピーの管理] ビューで、プライマリまたはセカンダリ (ミラーリングまたは複製された) ストレージ システムから [*バックアップ*] を選択します。
+
バックアップがカタログ化されていない場合は、バックアップを選択し、「カタログ」をクリックする必要があります。

. カタログ化されたバックアップを選択し、*をクリックします。image:../media/restore_icon.gif["復元アイコン"] *。
. [Restore Scope]ページで、次の作業を実行します。
+
.. Real Application Clusters（RAC）環境でデータベースのバックアップを選択した場合は、RACノードを選択します。
.. PDBとPDB内の表領域のどちらをリストアするかに応じて、次のいずれかの操作を実行します。
+
|===


| 状況 | 手順 


 a| 
PDBをリストアする
 a| 
... *プラガブル データベース (PDB)* を選択します。
... リストアするPDBを指定します。
+

NOTE: PDB$SEEDデータベースではPITRを実行できません。





 a| 
PDB内の表領域をリストアする
 a| 
... *プラガブル データベース (PDB) 表領域* を選択します。
... PDBを指定します。
... リストアする表領域を1つまたは複数指定します。
+

NOTE: SYSAUX、SYSTEM、UNDO表領域ではPITRを実行できません。



|===
.. データベースの状態を復元および回復操作を実行するために必要な状態に変更するには、「*復元および回復に必要な場合はデータベースの状態を変更する*」を選択します。


. [Recovery Scope]ページで、次のいずれかを実行します。
+
** 特定のシステム変更番号 (SCN) まで回復する場合は、「*Until SCN*」を選択し、SCN と補助宛先を指定します。
** 特定の日付と時刻に復元する場合は、「*日付と時刻*」を選択し、日付と時刻および補助の宛先を指定します。
+
SnapCenterは、指定したSCNまたは選択した日時に基づいて、PITRの実行に必要なデータ バックアップとログ バックアップの最適な数を特定し、マウントしてカタログ化します。



. [PreOps]ページで、リストア処理の前に実行するプリスクリプトのパスと引数を入力します。
+
プリスクリプトは、/var/opt/snapcenter/spl/scriptsパスまたはこのパス内の任意のフォルダに保存する必要があります。デフォルトでは、/var/opt/snapcenter/spl/scriptsがパスとして入力されています。スクリプトを保存するフォルダをこのパス内に作成してある場合は、パス内のそれらのフォルダを指定する必要があります。

+
スクリプトのタイムアウト値を指定することもできます。デフォルト値は60秒です。

+
SnapCenter、事前スクリプトと事後スクリプトを実行するときに、事前定義された環境変数を使用できます。link:../protect-sco/predefined-environment-variables-prescript-postscript-restore.html["詳細情報"^]

. [PostOps]ページで、次の手順を実行します。
+
.. リストア処理のあとに実行するポストスクリプトのパスと引数を入力します。
+

NOTE: リストア処理が失敗した場合、ポストスクリプトは実行されず、クリーンアップ アクティビティが直接トリガーされます。

.. リカバリ後にデータベースを開く場合は、チェック ボックスをオンにします。
+
RACセットアップでは、データベースがリカバリされたノードでのみPDBが開きます。リカバリしたPDBは、RACセットアップの他のすべてのノードで手動で開く必要があります。



. [通知] ページの [*電子メール設定*] ドロップダウン リストから、電子メール通知を送信するシナリオを選択します。
. 概要を確認し、[完了] をクリックします。
. *モニター* > *ジョブ* をクリックして、操作の進行状況を監視します。

