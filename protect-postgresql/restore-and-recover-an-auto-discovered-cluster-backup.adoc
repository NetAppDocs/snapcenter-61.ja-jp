---
permalink: protect-postgresql/restore-and-recover-an-auto-discovered-cluster-backup.html 
sidebar: sidebar 
keywords: SnapCenter Plug-in for postgresql 
summary: SnapCenterを使用して1つまたは複数のバックアップからデータをリストアおよびリカバリすることができます。 
---
= 自動検出されたクラスタ バックアップのリストアとリカバリ
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SnapCenterを使用して1つまたは複数のバックアップからデータをリストアおよびリカバリすることができます。

.開始する前に
* リソースまたはリソース グループをバックアップしておく必要があります。
* リストアするリソースまたはリソース グループに対して現在実行中のバックアップ処理がある場合は、すべてキャンセルしておく必要があります。
* リストア前、リストア後、マウント、アンマウントの各コマンドを実行する場合は、プラグイン ホストで次のパスから使用可能なコマンド リストにコマンドが存在するかどうかを確認する必要があります。
+
** Windows ホスト上のデフォルトの場所: _C:\Program Files\ NetApp\ SnapCenter\Snapcenter Plug-in Creator\etc\allowed_commands.config_
** Linux ホスト上のデフォルトの場所: _/opt/ NetApp/snapcenter/scc/etc/allowed_commands.config_





NOTE: コマンドがコマンド リストに存在しない場合、処理は失敗します。

.タスク概要
* ファイルベースのバックアップのコピーをSnapCenterからリストアすることはできません。
* 自動検出されたリソースについては、SFSRでリストアがサポートされます。
* 自動リカバリはサポートされていません。
* ONTAP 9.12.1以前のバージョンでは、リストアの一環としてSnapLock Vault Snapshotから作成されたクローンが、SnapLock Vaultの有効期限を継承します。SnapLockの有効期限が過ぎたあと、ストレージ管理者がクローンを手動でクリーンアップする必要があります。


.手順
. 左側のナビゲーション ペインで [*リソース*] をクリックし、リストから適切なプラグインを選択します。
. [リソース] ページで、リソース タイプに基づいて [*表示*] ドロップダウン リストからリソースをフィルターします。
+
リソースは、タイプ、ホスト、関連するリソース グループとポリシー、およびステータスとともに表示されます。

+

NOTE: リストアの実行時は、バックアップがリストア グループに対するものであっても、リストア対象のリソースを個別に選択する必要があります。

+
リソースが保護されていない場合は、「全体ステータス」列に「`保護されていません`」と表示されます。この状態になるのは、リソースが保護されていない場合とリソースが別のユーザによってバックアップされている場合です。

. リソースを選択するか、リソース グループを選択してそのグループ内のリソースを選択します。
+
リソースのトポロジ ページが表示されます。

. [コピーの管理] ビューで、プライマリまたはセカンダリ (ミラーリングまたはボールト化された) ストレージ システムから [*バックアップ*] を選択します。
. プライマリバックアップテーブルで、復元するバックアップを選択し、*をクリックします。image:../media/restore_icon.gif["復元アイコン"] *。
+
image::../media/restoring_resource.gif[資源の回復]

. 「復元範囲」ページで、「*完全なリソース*」を選択して、PostgreSQL クラスターの構成済みデータ ボリュームを復元します。
. [Recovery scope]ページで、次のいずれかのオプションを選択します。
+
|===


| 状況 | 操作 


 a| 
現在の時刻にできる限り近い時点にリカバリする場合
 a| 
*最新の状態に回復*を選択します。単一コンテナ リソースの場合は、ログおよびカタログ バックアップの場所を1つ以上指定します。



 a| 
指定した時点にリカバリする場合
 a| 
*特定の時点に回復*を選択します。

.. 日時を入力します。日時を入力します。たとえば、PostgreSQL Linuxホストがカリフォルニア州サニーベールにあり、ノースカロライナ州ローリーにいるユーザがログをSnapCenterにリカバリしようとしているとします。
+
ユーザーがカリフォルニア州サニーベールの午前5時にリカバリを実行したい場合、ユーザーはブラウザのタイムゾーンをPostgreSQL Linuxホストのタイムゾーン（GMT-07:00）に設定し、日付と時刻を午前5時に指定する必要があります。





 a| 
リカバリが不要である場合
 a| 
*回復なし*を選択します。

|===



NOTE: 手動で追加したPostgreSQLリソースはリカバリできません。


NOTE: PostgreSQL 用のSnapCenterプラグインは、手動でのリカバリを支援するために、_/<OS_temp_folder>/postgresql_sc_recovery_<Restore_JobId>/_ フォルダーに backup_label と tablespace_map を作成します。

. [Pre ops]ページで、リストア ジョブの実行前に実行するリストア前の処理とアンマウントのコマンドを入力します。
+
自動検出されたリソースにはアンマウント コマンドを使用できません。

. [Post ops]ページで、リストア ジョブの実行後に実行するマウントとリストア後の処理のコマンドを入力します。
+
自動検出されたリソースにはマウント コマンドを使用できません。

. 通知ページの *電子メール設定* ドロップダウン リストから、電子メールを送信するシナリオを選択します。
+
また、送信者と受信者のEメール アドレス、およびEメールの件名を指定する必要があります。SMTP は、[設定] > [グローバル設定] ページでも設定する必要があります。

. 概要を確認し、[完了] をクリックします。
. *モニター* > *ジョブ* をクリックして、操作の進行状況を監視します。

